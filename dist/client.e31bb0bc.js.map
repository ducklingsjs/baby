{"version":3,"sources":["camera.js","renderer.js","entity.js","../init_pose.json","index.js"],"names":["_setupCamera","video","document","getElementById","width","height","navigator","mediaDevices","getUserMedia","audio","facingMode","stream","srcObject","Promise","resolve","onloadedmetadata","loadVideo","play","setupRenderer","containerId","scene","THREE","Scene","camera","OrthographicCamera","position","z","renderer","WebGLRenderer","antialias","alpha","setPixelRatio","window","devicePixelRatio","setSize","container","appendChild","domElement","hemiLight","HemisphereLight","set","add","X_OFFSET","Y_OFFSET","Entity","group","name","Vector3","geometry","material","textureLoader","TextureLoader","setCrossOrigin","texture","load","center","repeat","rotation","Math","PI","MeshStandardMaterial","map","SphereGeometry","MeshLambertMaterial","color","sphere","Mesh","initialise","x","y","update","display","module","exports","bodyParts","Group","trackers2","nose","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle","forEach","item","tracker","poseExample","main","posenet","net","estimateSinglePose","poses","score","keypoints","filter","includes","part","d","i","render","requestAnimationFrame","changeClass","newClass","console","log"],"mappings":"AGAAwE,MAAM,CAACC,OAAP,GAAiB;AACf,UAAQ;AACN,ACFJ,SDES,kBADC;AAEN,SAAK;AAFC,ACAV,GDDiB;AAKf,kBAAgB;AACd,ADNJ,AEEA,IFFM/B,KCMG,GDNK,GAAG,GAAjB,SCKkB;AAEd,ADNJ,ADDO,ICCDC,KCMG,AFPOzB,GCCF,GAAG,GAAjB,IDDO,CAAuBC,WAAvB,EAAoC;AEKzB,ACDlB,AHHE,GEDe,GFCTf,KAAK,GAAG,IAAd;AEQA,ADNK,ADDL,MAAMC,GCCQuC,GDDF,GCCP,ADDU,CCCMC,EDDrB,CEOiB,EDNZ,EAAuBC,IAAvB,EAA6B;ACOhC,ADNF,ADAA,MAAM1B,CCADK,ECME,EFNI,GAAG,CCAd,GAAgB,ADAEJ,ICAEA,CDAG,CAACC,GEKP,ADLQ,CAACyB,CDAZ,EAAd,ICAgB,EAAhB;ACOE,ADLF,ADDA,MCCIC,ADDEzB,GEMC,AHXMvB,GCKD,ECCZ,CDDe,IAAIqB,KAAK,CAACG,kBAAV,CAA6B,CAA7B,EAAgCpB,KAAhC,EAAuC,CAAvC,EAA0CC,MAA1C,EAAkD,GAAlD,EAAuD,IAAvD,CAAf;AEIiB,ADFjB,ADDAkB,EAAAA,CENe,GDOX0B,EDDE,CAACxB,KCCP,GDDA,CAAgBC,CAAhB,GAAoB,GAApB;AEOA,AFLA,MAAMC,QAAQ,CEKD,EFLI,IAAIN,KAAK,CAACO,aAAV,CAAwB;AEMvC,ADLF,ADD2CC,IAAAA,ECCvCiB,GCKG,CDLC,GDD4C,ECCvC,ADDyC,IAAb,ECCzC,EAAqB,ICIR;AAEX,ADLA,ADF0DhB,IAAAA,ICEpDoB,CCKD,AFP0D,EAAE,UCE9C,GAAG,IAAI7B,KAAK,CAAC8B,aAAV,EAAtB;ACGW,ADFXD,AELJ,AHE2C,GER1B,AFQE,CCGfA,ADHF,aCGe,CAACE,cAAd,CAA6B,GAA7B,sCFXJ;AGiBE,AHjBF,AEaI,ADJFzB,EAAAA,MCIQ0B,EDJA,CAACtB,ICIM,CCID,EDJImB,MDJlB,CAAuBlB,MCIQ,ADJF,CCIGsB,ADJFrB,ICIZ,CAAmB,WDJrC,cCIkB,CAAhB;ACKA,AHlBJ,AEcIoB,AEPJ,AHGE1B,EAAAA,ECIE0B,KCIK,CFRC,CCIC,ADJAnB,CCICqB,MAAR,ADJF,CCIiBf,ADJApC,EGHiB,CFOhC,CAAmB,CDJrB,EEOc,AFPUC,CCItB,EAAyB,GAAzB,ADJF,kBGHgD,gBAAd,CAApC;ADYI,AHnBJ,AEeIgD,AERJ,AHKE,ICGEA,AERI1B,EHKAQ,GEOC,EDJE,CAACqB,AERZ,GHKiB,GCGb,ADHgBtD,CCGDsC,GAAf,CAAmB,CAAnB,EAAsB,ADHE,CAACrC,ECGzB,CERIwB,QAAR,GHKoB,CAAwBR,WAAxB,CAAlB;AEKc,AHjBhB,AEiBIkC,AEVJ,AHMElB,EAAAA,CEbe,CDiBbkB,AEVcjC,KAAlB,EFUW,ADJA,CCICqC,ADJArB,QCIR,GAAmBsB,ADJrB,CAAsB/B,GCIG,AEVTP,CFUUuC,EAAxB,EEVJ,AHMgC,CAACtB,UAA/B;AEQA,AHrBF,AEkBIY,AEXJ,AHQE,ICGEA,AEXqB1B,EHQjBe,IGRR,EFWY,GCGG,ADHA,ADHE,GAAG,CCGDjB,GDHKA,ECGA,CAACuC,EDHI,CGRJrC,AHQKgB,MGR9B,SHQoB,CAA0B,CCG/B,CAA+B,ODH1B,EAAqC,SAArC,EAAgD,CAAhD,CAAlB;AEOE,AHrBItC,AEkBF4D,ADHJvB,EAAAA,ICGIuB,GCGG,ADHA,EAAER,ADHA,CDfHpD,ACeIwB,KDhBZ,GACgBvB,ACed,CAAmBsC,GAAnB,CAAuB,CEKV,AFLb,EDfsB,ACeI,CDfHrC,ACevB,EAA6B,CAA7B,WDfc,CAAwB,QAAxB,CADhB;AGuBI,AHrBFF,AEgB4C,AET9C,AHQEmB,EAAAA,EGRIsD,CFSS,CAAX,CDDG,CAACjC,CEMC,EFNP,CDfAxC,ACeUqC,CGRG,GAAG,CJPX,AIQL,CJRMlC,GCeN,EDfA,AIOgB,EAEhB,CJTc,GAAd,UIOgB,EAGhB,eAHgB,EAIhB,WAJgB,EAKhB,YALgB,EAMhB,WANgB,EAOhB,YAPgB,EAQhB,SARgB,EAShB,UATgB,EAUhB,UAVgB,EAWhB,WAXgB,EAYhB,WAZgB,EAahB,YAbgB,CAAlB;ADYe,AHlBbH,AEmBE+C,AEGJ,AHNE,GEnBe,CDsBbA,AEGEH,KAAK,AHNF,GDhBP5C,AEmBU,AEGE,GFHC,CEGGoB,CJtBX,CAAChB,CEmBWgB,EEGI,CAACsD,EJtBtB,AEmBsB,CAACb,EFnBR,AIsBH,EAAd,CJtBE,SEmBa,CAAyB,EAAzB,EAA6B,EAA7B,EAAiC,EAAjC,CAAX;ACGF,AHzBF,AEuBG,AEGH1C,AHPWO,GCVT,CDUSA,CGON,CAACc,GFHG,AEGT,CAAUI,EHPS,EAARlB,CGOX,CDDgB,MFNP;AEOL,AH1BJ,AEwBIsB,AEIJ,AHTqB7B,ICKjB6B,AEIA2B,AHTiBxD,KEOZ,AFPiB,EAALA,CCKT,CEIC,EFJE,CEIC,AHTP,GDdcd,AEmBJe,KAAK,CAAC0C,CCCT,EHpBgB,CAACxD,YAAV,CAAuBC,EEmB/B,CAA8B,SFnBtB,CAAoC;AGsBvD,AHrBAC,AEmBEuD,AEIJa,AHV0BtD,EGU1BsD,EHV0BtD,ECMtByC,AEIA,EAAE,CDFC,CCCO,AHTkB,CCMvB,CDNiBzC,CCMf,CFnBTd,KAAK,EAAE,KADgD;AGoB3C,AHlBZR,AEiByC,AEM3C6E,AHXO,EGWPA,CD9Be,AFmBf,ECKa,CAAX,QFjBA7E,AIuBU,EAAE,EAFA,CJrBP,EAAE;AGsBT,AHrBIS,AEoBFsC,AEGF+B,AHXD,EGWCA,EFHE/B,QAAQ,CCCC,EDDE,AEGA,CJvBTtC,CIuBW,EFHEW,AEAH,KFAQ,CAACyC,CFpBT,EAAE,MADP,KEqBI,CAAyB,EAAzB,EAA6B,CAA7B,EAAgC,CAAhC,CAAX;ACEA,AHrBE1D,AEoBH,AEGD4E,EAAAA,ODFO,ECEE,EAAE,EAJG,CJnBV5E,KAAK,EAAE,GAFF,CGsBE;AAET,AHrBEC,AIuBJ4E,EAAAA,ODFO,GCEG,EAAE,EJvBR5E,AIkBU,MJlBJ,EAAE;AGmBD,AHtBF,AEwBT,AEGA6E,EAAAA,CDlCe,GD+BTjB,KEGG,CFHG,CEGD,EFHI,AEHD,IFGK5C,KAAK,CAAC6C,IAAV,CAAelB,QAAf,EAAyBC,QAAzB,CAAf;ACEA,AH5ByD,AE2BzDJ,AEGAsC,EFHAtC,AEGAsC,KFHK,CAAC1C,GAAN,CAAUwB,AEGA,CJ9BW,CG4BT,AHjCd,AImCc,EAPE,EFId;ACEE,ACEFmB,EAAAA,ODFO,ACEA,EAAE,EARK,cDKF;AAEV,AHnCJ,AEkCE,AEGAC,EAAAA,KFHKlB,ECCE,CCEC,EAAE,EATI,GFMd,GAAkB,YAAY;ACDlB,AH5BNxD,AE8BJ,AEGF2E,EAAAA,CDtCe,MDmCR7D,CEGC,EJjCFd,AIiCI,EAVI,GFOZ,CFnCJ,AEmCkByD,CAAd,GAAkB1B,QAAlB;ACEF,AHxBAzC,AEuBE,AEGFsF,EAAAA,OFHO9D,EEGE,CJ1BTxB,CI0BW,CDFC,CCTE,EJfT,AEuBH,CFvBIW,AEuBUyD,CAAd,GAAkB1B,KFvBpB,GAAkBhC,AEuBhB,MFvBF;AGyBE,AHtCJ,AEqCI,AEGF6E,EAAAA,ODFO,ADDA/D,EEGE,EAAE,EAZG,EFSZ,CAAcC,CAAd,GAAkB,CAAlB,ICAU,kBHtBL,IAAIb,OAAJ,CAAY,UAACC,OAAD,EAAa;AGwB9B,AHvBAb,AEsBD,AEGDwF,EAAAA,CFPA,MCKO,GCEG,EJzBRxF,AIyBU,KJzBL,CAACc,gBAAN,GAAyB,YAAM;AGqBrB,AHpBRD,AIWU,CAAhB,ED5BiB,aHiBXA,OAAO,CAACb,KAAD,CAAP;AGwBJ,AHvBG,AEsBH,AEIFyE,OFJOJ,EEIE,CAACoB,GFJR,ECCa,AHzBX,CEwBY,CEIhB,CAAkB,QFJQtB,CAAV,CEIGuB,CFJUtB,CAAb,EAAgB3C,AEId,CFJF,CEIY,CFJO;ACE/B,AHvBD,AEsBC,AEIF,MAAIkE,GDHG,ADDAnE,IF1BA,AI8BI,CJ7Cb,EI6CgB,CFJZ,CAAc2C,CAAd,CEIgBxB,EFJEF,KCAP,GDAe,GAAG0B,CAA7B,AEIY,CAAWvB,KAAX,EAAkB8C,IAAlB,CAAd;ADFE,ADDA,AEIFC,EAAAA,ODHO,ADDAnE,AEIA,CAAC0C,OFJN,CAAcE,CAAd,CEIF,EFJoB1B,QAAQ,GAAG0B,CAAX,IAAgBvB,IAAI,KAAK,MAAT,GAAkB,CAAC,EAAnB,GAAwB,CAAxC,CAAlB;ACDW,AHzCf,AE2CI,AEIF8C,EAAAA,CD/Ce,MD2CRnE,AEIA,CAAC6C,MAAR,CFJE,AEIauB,CFJCnE,CAAd,GAAkBA,CAAlB,aEIyBiE,IAAZ,EAAkBvB,CAAjC,EAAoCyB,mBAAYF,IAAZ,EAAkBtB,CAAtD,EAAyD,CAAzD;ADFA,AH7CF,AE4CG,AEIDuB,EAAAA,CFRA,MEQO,CAACrB,KDHK,ECGb;ADFE,AH9CJ,AIkDEK,EAAAA,ODJO,ECIE,CAACe,IAAD,CAAT,GAAkBC,MDLL,CCKb;ADHE,AH/CJ,AE8CE,AEKD,CAPD,GASA,GFPOrB,ECCE,KDDP,GAAe,YAAY;ACDd,AH7Cf,AE+CIN,GC/Ca,CD+CbA,MAAM,CAACxC,QAAP,CAAgB2C,CAAhB,GAAoB,KAAK3C,QAAL,CAAc2C,CAAlC;ACEF,AHjDF,AEgDIH,IAAAA,KEMW6B,CFNL,CAACrE,KCCK,GDDZ,CAAgB4C,CAAhB,GAAoB,KAAK5C,QAAL,CAAc4C,CAAlC;ACEA,AHlDJ,AEiDIJ,IAAAA,KCCK,CDDC,CAACxC,QAAP,CAAgBC,CAAhB,GAAoB,GCAR,EDAaD,QAAL,CAAcC,CAAlC;ACEA,ADDD,GAJD,MCKO;AAFO,ADEf;ACnDgB,CAAjB;SHsBsBV,yDIgCtB;AAAA;AAAA;AAAA;AAAA;AAAA,uEJhCO;AAAA,AIgCP;AJhCO,AIgCP,mBACoB+E,OAAO,CAACzC,IAAR,EADpB;AJhCO;AAAA,AIgCP;AJhCO,AIiCC0C,YAAAA,GADR;AJhCO,AIgCP;AJhCO,AIgCP,mBJ/BsBhG,AIkCA,YJlCY,EAD3B,UIgCP;;AJhCO,AIgCP;AJ/BQC,AIkCAA,YJlCAA,AIkCAA,KJnCD,AIgCP;AJ9BEA,AI8BF,YJ9BEA,KAAK,CAACgB,IAAN;AAFK,AIgCP,mBAKsB+E,GAAG,CAACC,kBAAJ,CAAuBhG,IJjCpCA,CIiCa,CALtB,GJhCO;;AAAA,AIgCP;AJhCO,AIqCCiG,YAAAA,KALR;AJhCO;AAAA,AIuCL,gBAAIA,KAAK,CAACC,KAAN,GAAc,GAAlB,EAAuB;AJvClB,AIwCHD,cAAAA,KAAK,CAACE,SAAN,CACGC,MADH,CACU,UAACV,IAAD;AJzCP,AIyCO,uBAAUjB,SAAS,CAAC4B,QAAV,CAAmBX,IAAI,CAACY,IAAxB,CAAV;AJzCP,AIyCO,eADV,EAEGb,OAFH,CAEW,UAACc,CAAD,EAAIC,CAAJ,EAAU;AACjB7B,gBAAAA,SAAS,CAAC4B,CAAC,CAACD,IAAH,CAAT,CAAkBjC,MAAlB,CAAyBkC,CAAC,CAAC/E,QAAF,CAAW2C,CAAX,GAAe,CAAxC,EAA2CoC,CAAC,CAAC/E,QAAF,CAAW4C,CAAX,GAAe,CAA1D,EAA6D,CAA7D;AACAO,gBAAAA,SAAS,CAAC4B,CAAC,CAACD,IAAH,CAAT,CAAkBhC,OAAlB;AACD,eALH;AAMD;;AAED5C,YAAAA,QAAQ,CAAC+E,MAAT,CAAgBtF,KAAhB,EAAuBG,MAAvB;AACAoF,YAAAA,qBAAqB,CAACb,IAAD,CAArB;;AAjBF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAoBA,SAASc,WAAT,CAAqBC,QAArB,EAA+B;AAC7BC,EAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;AACD;;AAEDf,IAAI","file":"client.e31bb0bc.js","sourceRoot":"../client","sourcesContent":["async function _setupCamera() {\n  const video = document.getElementById(\"camera\");\n  video.width = 300;\n  video.height = 300;\n\n  const stream = await navigator.mediaDevices.getUserMedia({\n    audio: false,\n    video: {\n      facingMode: \"user\",\n      width: 300,\n      height: 300,\n    },\n  });\n  video.srcObject = stream;\n\n  return new Promise((resolve) => {\n    video.onloadedmetadata = () => {\n      resolve(video);\n    };\n  });\n}\n\nexport async function loadVideo() {\n  const video = await _setupCamera();\n  video.play();\n\n  return video;\n}\n","export function setupRenderer(containerId) {\n  const width = 1280;\n  const height = 967;\n\n  const scene = new THREE.Scene();\n  const camera = new THREE.OrthographicCamera(0, width, 0, height, 0.1, 1000);\n  camera.position.z = 500;\n\n  const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n  renderer.setPixelRatio(window.devicePixelRatio);\n  renderer.setSize(width, height);\n\n  const container = document.getElementById(containerId);\n  container.appendChild(renderer.domElement);\n\n  const hemiLight = new THREE.HemisphereLight(\"#EFF6EE\", \"#EFF6EE\", 1);\n  hemiLight.position.set(0, 0, 0);\n  scene.add(hemiLight);\n\n  return { renderer, scene, camera };\n}\n","const X_OFFSET = 700;\nconst Y_OFFSET = 400;\n\nexport function Entity(group, name) {\n  this.position = new THREE.Vector3();\n\n  let geometry;\n  let material;\n\n  if (name === \"nose\") {\n    const textureLoader = new THREE.TextureLoader();\n    textureLoader.setCrossOrigin(\"*\");\n\n    const texture = textureLoader.load(\"brad_pitt2.94ce350a.png\");\n    texture.center.set(0.67, 0.5);\n    texture.repeat.set(2, 1.2);\n\n    texture.rotation = Math.PI;\n    material = new THREE.MeshStandardMaterial({\n      map: texture,\n    });\n\n    geometry = new THREE.SphereGeometry(35, 30, 10);\n  } else {\n    material = new THREE.MeshLambertMaterial({\n      color: \"white\",\n    });\n\n    geometry = new THREE.SphereGeometry(15, 7, 7);\n  }\n\n  const sphere = new THREE.Mesh(geometry, material);\n  group.add(sphere);\n\n  this.initialise = function () {\n    this.position.x = X_OFFSET;\n    this.position.y = Y_OFFSET;\n    this.position.z = 0;\n  };\n\n  this.update = function (x, y, z) {\n    this.position.x = X_OFFSET + x;\n    this.position.y = Y_OFFSET + y + (name === \"nose\" ? -20 : 0);\n    this.position.z = z;\n  };\n\n  this.display = function () {\n    sphere.position.x = this.position.x;\n    sphere.position.y = this.position.y;\n    sphere.position.z = this.position.z;\n  };\n}\n","module.exports = {\n  \"nose\": {\n    \"x\": 153.74737453831773,\n    \"y\": 80.38843949017358\n  },\n  \"leftShoulder\": {\n    \"x\": 182.57633313130776,\n    \"y\": 122.59830222519456\n  },\n  \"rightShoulder\": {\n    \"x\": 112.43237744045629,\n    \"y\": 121.39704663465923\n  },\n  \"leftElbow\": {\n    \"x\": 206.03540324051556,\n    \"y\": 177.68850363646038\n  },\n  \"rightElbow\": {\n    \"x\": 91.94506634070252,\n    \"y\": 178.27901877317913\n  },\n  \"leftWrist\": {\n    \"x\": 179.3344401199994,\n    \"y\": 210.93295798691332\n  },\n  \"rightWrist\": {\n    \"x\": 89.60033669082108,\n    \"y\": 221.2291672999757\n  },\n  \"leftHip\": {\n    \"x\": 172.31724364284412,\n    \"y\": 235.65967723089435\n  },\n  \"rightHip\": {\n    \"x\": 124.68208877029123,\n    \"y\": 233.72739799291708\n  },\n  \"leftKnee\": {\n    \"x\": 201.01856276218996,\n    \"y\": 248.88685649471063\n  },\n  \"rightKnee\": {\n    \"x\": 122.32447227151478,\n    \"y\": 300.5203900170234\n  },\n  \"leftAnkle\": {\n    \"x\": 263.3188091827274,\n    \"y\": 287.3314349103995\n  },\n  \"rightAnkle\": {\n    \"x\": 127.30199316596243,\n    \"y\": 308.7169958923578\n  }\n}\n;","import { loadVideo } from \"./camera\";\nimport { setupRenderer } from \"./renderer\";\nimport { Entity } from \"./entity\";\n\nimport poseExample from \"../init_pose.json\";\n\nloadVideo();\nconst { renderer, scene, camera } = setupRenderer(\"threeContainer\");\n\nconst bodyParts = [\n  \"nose\",\n  \"leftShoulder\",\n  \"rightShoulder\",\n  \"leftElbow\",\n  \"rightElbow\",\n  \"leftWrist\",\n  \"rightWrist\",\n  \"leftHip\",\n  \"rightHip\",\n  \"leftKnee\",\n  \"rightKnee\",\n  \"leftAnkle\",\n  \"rightAnkle\",\n];\n\nconst group = new THREE.Group();\nscene.add(group);\n\nlet trackers2 = {\n  nose: {},\n  leftShoulder: {},\n  rightShoulder: {},\n  leftElbow: {},\n  rightElbow: {},\n  leftWrist: {},\n  rightWrist: {},\n  leftHip: {},\n  rightHip: {},\n  leftKnee: {},\n  rightKnee: {},\n  leftAnkle: {},\n  rightAnkle: {},\n};\n\nbodyParts.forEach((item) => {\n  let tracker = new Entity(group, item);\n  tracker.initialise();\n  tracker.update(poseExample[item].x, poseExample[item].y, 0);\n  tracker.display();\n\n  trackers2[item] = tracker;\n});\n\n// main render loop\nasync function main() {\n  const net = await posenet.load();\n\n  const video = await loadVideo();\n\n  const poses = await net.estimateSinglePose(video);\n\n  if (poses.score > 0.8) {\n    poses.keypoints\n      .filter((item) => bodyParts.includes(item.part))\n      .forEach((d, i) => {\n        trackers2[d.part].update(d.position.x * 1, d.position.y * 1, 0);\n        trackers2[d.part].display();\n      });\n  }\n\n  renderer.render(scene, camera);\n  requestAnimationFrame(main);\n}\n\nfunction changeClass(newClass) {\n  console.log(newClass);\n}\n\nmain();\n"]}